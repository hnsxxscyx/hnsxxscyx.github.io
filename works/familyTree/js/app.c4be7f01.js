(function(e){function t(t){for(var n,o,l=t[0],s=t[1],c=t[2],u=0,f=[];u<l.length;u++)o=l[u],i[o]&&f.push(i[o][0]),i[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);d&&d(t);while(f.length)f.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,l=1;l<a.length;l++){var s=a[l];0!==i[s]&&(n=!1)}n&&(r.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},i={app:0},r=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=s;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"380f":function(e,t,a){"use strict";var n=a("ba0f"),i=a.n(n);i.a},"3f48":function(e,t,a){"use strict";var n=a("a97b"),i=a.n(n);i.a},"44f9":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("dac5"),a("6e26"),a("9604"),a("df67");var n=a("6e6d"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},r=[],o=a("17cc"),l={},s=Object(o["a"])(l,i,r,!1,null,null,null),c=s.exports,d=a("1e6f"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"index"},[a("div",{staticClass:"family-key-wrapper"},[a("h4",[e._v(e._s(e.$store.state.activeKey?"当前您操作的家谱名字为:"+e.$store.state.activeKey:"请先选择或新建家谱"))]),a("span",[a("p",[e._v("选择已有家谱:")]),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeAcitveFamily},model:{value:e.activeFamilyKey,callback:function(t){e.activeFamilyKey=t},expression:"activeFamilyKey"}},e._l(e.familySelect,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("span",{staticClass:"add"},[a("p",[e._v("添加新家谱:")]),a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.newFamily,callback:function(t){e.newFamily=t},expression:"newFamily"}}),a("el-button",{on:{click:e.createNewFamily}},[e._v("添加")])],1)]),a("div",{staticClass:"tab"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.routeTo("/familyManage")}}},[e._v("管理家谱成员")]),a("el-button",{attrs:{type:"text"},on:{click:function(t){return e.routeTo("/familyTree")}}},[e._v("查看家谱树")]),a("el-button",{attrs:{type:"text"},on:{click:e.setPredefinedData}},[e._v("一键导入预定义数据")])],1)])},f=[],m=(a("f763"),a("fb37"),{data:function(){return{activeFamilyKey:"",newFamily:""}},methods:{changeAcitveFamily:function(e){this.$store.commit("updateActiveKey",e)},createNewFamily:function(){var e=this.newFamily;e?this.$store.commit("newFamily",e):this.$message.error("请填写家族名")},routeTo:function(e){this.$store.state.activeKey?this.$router.push(e):this.$message.error("请先选择或添加一个家谱")},setPredefinedData:function(){var e={"邮件例子":[{motherId:"4",fatherId:"3",birthday:"1990-01-01",sex:"男",name:"王大锤",id:1},{motherId:"4",fatherId:"3",birthday:"1990-02-01",sex:"女",name:"王尼美",id:2},{birthday:"1970-02-03",sex:"男",name:"王建国",id:3},{birthday:"1970-06-09",sex:"女",name:"李秀英",id:4},{motherId:"2",birthday:"2010-04-04",sex:"男",name:"赵铁柱",id:5},{fatherId:"1",birthday:"2010-05-05",sex:"男",name:"王小明",id:6}],"测试家谱1":[{birthday:"2019-06-04",sex:"男",name:"1",id:1},{birthday:"2019-06-05",sex:"男",name:"2",id:2},{fatherId:"1",birthday:"2019-06-13",sex:"男",name:"3",id:3},{motherId:"2",birthday:"2019-06-05",sex:"男",name:"4",id:4},{fatherId:"1",birthday:"2019-06-26",sex:"女",name:"5",id:5},{fatherId:"5",birthday:"2019-06-11",sex:"女",name:"6",id:6},{motherId:"6",birthday:"2019-06-04",sex:"男",name:"7",id:7},{fatherId:"4",birthday:"2019-06-12",sex:"男",name:"9",id:8}]};this.$store.commit("setPredefinedData",e),this.$message("数据导入成功，您现在可直接选择家谱")}},computed:{familySelect:function(){return Object.keys(this.$store.state.allFamilyInfo).map(function(e){return{label:e,value:e}})}}}),p=m,h=(a("b3b3"),Object(o["a"])(p,u,f,!1,null,"98c7f5ea",null)),b=h.exports,v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"family-tree-wrapper"},[a("div",{staticClass:"tree-wrapper"},[a("TreeChart",{attrs:{json:e.demoData},on:{"click-node":e.clickNode}})],1),a("div",{staticClass:"relation-wrapp"},[a("p",[e._v("成员A:"+e._s(e.memberA.data&&e.memberA.data.name||"点击选择节点选择成员"))]),a("p",[e._v("成员B:"+e._s(e.memberB.data&&e.memberB.data.name||"点击选择节点选择成员"))])]),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:e.compareRelation}},[e._v("比较关系")]),a("el-button",{attrs:{type:"danger"},on:{click:e.clearMember}},[e._v("清除成员")])],1)])},y=[],I=(a("cde0"),a("608b"),a("7364"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.treeData.name?a("table",[a("tr",[a("td",{class:{parentLevel:e.treeData.children,extend:e.treeData.children&&e.treeData.extend},attrs:{colspan:e.treeData.children?2*e.treeData.children.length:1}},[a("div",{class:{node:!0,hasMate:e.treeData.mate}},[a("div",{staticClass:"person",on:{click:function(t){return e.clickNode(e.treeData,t)}}},[a("div",{staticClass:"avat"},[a("img",{attrs:{src:e.treeData.image_url?e.treeData.image_url:"男"===e.treeData.sex?"man.png":"woman.png"}})]),a("div",{staticClass:"name"},[e._v(e._s(e.treeData.name))]),e.treeData.birthday?a("div",{staticClass:"birthday"},[e._v(e._s(e.treeData.birthday))]):e._e()]),e.treeData.mate?a("div",{staticClass:"person",on:{click:function(t){return e.$emit("click-node",e.treeData.mate)}}},[a("div",{staticClass:"avat"},[a("img",{attrs:{src:e.treeData.mate.image_url}})]),a("div",{staticClass:"name"},[e._v(e._s(e.treeData.mate.name))]),a("div",{staticClass:"name"},[e._v(e._s(e.treeData.mate.name))])]):e._e()]),e.treeData.children?a("div",{staticClass:"extend_handle",on:{click:function(t){return e.toggleExtend(e.treeData)}}}):e._e()])]),e.treeData.children&&e.treeData.extend?a("tr",e._l(e.treeData.children,function(t,n){return a("td",{key:n,staticClass:"childLevel",attrs:{colspan:"2"}},[a("TreeChart",{attrs:{json:t},on:{"click-node":e.clickNode}})],1)}),0):e._e()]):e._e()}),x=[],g={name:"TreeChart",props:["json"],data:function(){return{treeData:{}}},watch:{json:{handler:function(e){var t=function e(t){return t.extend=void 0===t.extend||!!t.extend,Array.isArray(t.children)&&t.children.forEach(function(t){e(t)}),t};e&&(this.treeData=t(e))},immediate:!0}},methods:{toggleExtend:function(e){e.extend=!e.extend,this.$forceUpdate()},clickNode:function(e,t){this.$emit("click-node",e,t)}}},D=g,_=(a("3f48"),Object(o["a"])(D,I,x,!1,null,"99870c2a",null)),k=_.exports,w=a("ac59"),$=a.n(w),F={components:{TreeChart:k},created:function(){var e=this.getTreeData();this.demoData={name:"".concat(this.activeFalimy,"家谱"),image_url:"home.png",children:e}},data:function(){return{demoData:{},memberA:{},memberB:{}}},methods:{clickNode:function(e,t){e.name==="".concat(this.activeFalimy,"家谱")?this.$message.error("家谱根节点不是成员不能被选中哦"):0===Object.keys(this.memberA).length?this.memberA={data:e,domNode:t.target}:0===Object.keys(this.memberB).length&&(this.memberB={data:e,domNode:t.target})},clearMember:function(){this.memberA={},this.memberB={}},compareRelation:function(){var e=this,t=this.memberA,a=this.memberB,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TABLE";while(e&&e.nodeName!==t)e=e.parentNode;return e},i=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TABLE",n=0;while(e!==t)e.nodeName===a&&n++,e=e.parentNode;return n},r=function(e,t){var a=$()(e),n=$()(t),i=0;return a.isSame(n)||(i=a.isBefore(n)?1:-1),i},o=function(t){return e.infoList.find(function(e){return e.id==t})},l="";if(t.data.id===a.data.id)l="这俩人是一个人呀，别闹";else{var s=n(t.domNode),c=n(a.domNode),d=s.contains(c)||c.contains(s),u=document.querySelector(".family-tree-wrapper table"),f=i(s,u),m=i(c,u),p=f-m,h=o(t.data.fatherId),b=!!h;if(Math.abs(p)>=3)l="您想查的关系还没来的及做哦，能再多点时间就好啦";else if(d)switch(p){case-1:l="男"===a.data.sex?"儿子":"女儿";break;case-2:l=o(a.data.fatherId)?"".concat("男"===a.data.sex?"孙子":"孙女"):"".concat("男"===a.data.sex?"外孙":"外孙女");break;case 1:l="男"===a.data.sex?"爸爸":"妈妈";break;case 2:l="".concat(b?"男"===a.data.sex?"爷爷":"奶奶":"男"===a.data.sex?"姥爷":"姥姥");break;default:break}else if(0===p){var v=r(t.data.birthday,a.data.birthday);if(t.data.fatherId===a.data.fatherId||t.data.motherId===a.data.motherId)switch(v){case 0:l="双胞胎".concat("男"===a.data.sex?"兄弟":"兄妹");break;case 1:l="亲".concat("男"===a.data.sex?"弟弟":"妹妹");break;case-1:l="亲".concat("男"===a.data.sex?"哥哥":"姐姐");break;default:break}else switch(v){case 0:l="表".concat("男"===a.data.sex?"兄弟":"兄妹");break;case 1:l="表".concat("男"===a.data.sex?"弟":"妹");break;case-1:l="表".concat("男"===a.data.sex?"哥":"姐");break;default:break}}else if(p<0)switch(p){case-1:l="侄".concat("男"===a.data.sex?"子":"女");break;case-2:l="".concat(o(a.data.motherId).motherId==t.data.id?"":"侄").concat("男"===a.data.sex?"孙":"孙女");break;default:break}else switch(p){case 1:if(b){var y=r(h.birthday,a.data.birthday)?"叔叔":"大伯",I=a.data.id==t.data.motherId?"妈妈":"姑姑";l="".concat("男"===a.data.sex?y:I)}else l="".concat("男"===a.data.sex?"舅舅":"姨姨");break;case 2:l="".concat(b?"男"===a.data.sex?"爷爷":"姑奶":"男"===a.data.sex?"姥爷":"姥姥");break;default:break}}this.$alert("".concat(t.data.name,"叫").concat(a.data.name,":").concat(l),"关系判定")},getTreeData:function(){this.$store.state.activeKey;var e=this.infoList,t=function(e){return e=JSON.parse(JSON.stringify(e)),e.forEach(function(t,a){if(t.isDelete);else{var n=e.findIndex(function(e){return e.id&&(e.id==t.fatherId||e.id==t.motherId)});-1!==n&&(Array.isArray(e[n].children)?e[n].children.push(t):e[n].children=[t],e[a].isDelete=!0)}}),console.log(e),e.filter(function(e){return!e.isDelete})};console.log(e);var a=t(e);return console.log(a),a}},computed:{activeFalimy:function(){return this.$store.state.activeKey},infoList:function(){return this.$store.getters.activeFamilyInfo}}},P=F,j=(a("ac2e"),Object(o["a"])(P,v,y,!1,null,"3f65f173",null)),C=j.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"manage"},[a("FamilyTable",{on:{changePeopleInfo:e.openEditPeopleInfoDialog}}),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.openEditPeopleInfoDialog({})}}},[e._v("添加人员")])],1),a("el-dialog",{attrs:{title:"人员信息",visible:e.dialogIsShow},on:{"update:visible":function(t){e.dialogIsShow=t}}},[e.dialogIsShow?a("EditPeopleInfo",{attrs:{existPeopleInfo:e.activePeopleInfo},on:{closeDialog:e.closeDialog}}):e._e()],1)],1)},S=[],T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-wrapper"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.familyInfoList}},[e._l(e.tableList,function(t,n){return a("el-table-column",{key:n,attrs:{align:"center",label:t.label},scopedSlots:e._u([{key:"default",fn:function(n){return[a("span",[e._v(e._s(n.row[t.prop]||"0"===n.row[t.prop]?""+n.row[t.prop]+(t.rightText?t.rightText:""):"—"))])]}}],null,!0)})}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.changePeopleInfo(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.deletePeopleInfo(t.row)}}},[e._v("删除")])]}}])})],2)],1)},A=[],E={data:function(){return{p:1,pagesize:10,tableList:[{label:"ID",prop:"id"},{label:"姓名",prop:"name"},{label:"姓别",prop:"sex"},{label:"生日",prop:"birthday"},{label:"父亲ID",prop:"fatherId"},{label:"母亲ID",prop:"motherId"}]}},computed:{familyInfo:function(){return this.$store.getters.activeFamilyInfo},familyInfoList:function(){var e=this.pagesize*this.p,t=(this.pagesize,this.familyInfo);return t}},methods:{deletePeopleInfo:function(e){this.$store.commit("deletePeopleInfo",e)},changePeopleInfo:function(e){console.log(e),this.$emit("changePeopleInfo",e)}}},K=E,N=Object(o["a"])(K,T,A,!1,null,"6d1d379f",null),M=N.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",attrs:{model:e.inputData,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.inputData.name,callback:function(t){e.$set(e.inputData,"name",t)},expression:"inputData.name"}})],1),a("el-form-item",{attrs:{label:"姓别"}},[a("el-radio",{attrs:{label:"男"},model:{value:e.inputData.sex,callback:function(t){e.$set(e.inputData,"sex",t)},expression:"inputData.sex"}},[e._v("男")]),a("el-radio",{attrs:{label:"女"},model:{value:e.inputData.sex,callback:function(t){e.$set(e.inputData,"sex",t)},expression:"inputData.sex"}},[e._v("女")])],1),a("el-form-item",{attrs:{label:"生日"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"请选择生日"},model:{value:e.inputData.birthday,callback:function(t){e.$set(e.inputData,"birthday",t)},expression:"inputData.birthday"}})],1),a("el-form-item",{attrs:{label:"父亲ID"}},[a("el-input",{attrs:{placeholder:"请输入父亲ID",min:"0"},model:{value:e.inputData.fatherId,callback:function(t){e.$set(e.inputData,"fatherId",t)},expression:"inputData.fatherId"}})],1),a("el-form-item",{attrs:{label:"母亲ID"}},[a("el-input",{attrs:{placeholder:"请输入母亲ID",min:"0"},model:{value:e.inputData.motherId,callback:function(t){e.$set(e.inputData,"motherId",t)},expression:"inputData.motherId"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("立即"+e._s(e.isCreate?"创建":"修改"))])],1)],1)},L=[],z=a("e20c"),J={created:function(){this.isCreate||(this.inputData=Object(z["a"])({},this.inputData,this.existPeopleInfo))},data:function(){return{inputData:{motherId:void 0,fatherId:void 0,birthday:"",sex:"",name:""}}},props:{existPeopleInfo:{type:Object,default:function(){return{}}}},computed:{isCreate:function(){return 0===Object.keys(this.existPeopleInfo).length}},methods:{submitForm:function(e){var t=this.isCreate?"createPeopleInfo":"updatePeopleInfo",a=Object(z["a"])({},this.inputData);void 0===this.existPeopleInfo.name||a.id||(a.id=0);var n=Object.keys(this.inputData),i=n.every(function(e){return e||0===e});i?(this.$store.commit(t,this.inputData),this.$emit("closeDialog")):this.$message.error("您必须输入所有参数")}}},R=J,q=Object(o["a"])(R,B,L,!1,null,"fd14a9c0",null),U=q.exports,G={data:function(){return{activePeopleInfo:{},dialogIsShow:!1}},components:{FamilyTable:M,EditPeopleInfo:U},methods:{openEditPeopleInfoDialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.activePeopleInfo=e,this.dialogIsShow=!0},closeDialog:function(){this.dialogIsShow=!1}},computed:{familyInfo:function(){return this.$store.getters.activeFamilyInfo}}},H=G,Q=(a("380f"),Object(o["a"])(H,O,S,!1,null,"adb484da",null)),V=Q.exports;n["default"].use(d["a"]);var W=new d["a"]({routes:[{path:"/",name:"index",component:b},{path:"/familyTree",name:"familyTree",component:C},{path:"/familyManage",name:"FamilyManage",component:V}]}),X=a("591a"),Y=a("f1f5");n["default"].use(X["a"]);var Z=new Y["a"]({storage:window.sessionStorage}),ee=new X["a"].Store({state:{allFamilyInfo:{},activeKey:"",activePeopleInfo:{},treeFamilyInfo:{}},getters:{activeFamilyInfo:function(e){var t=e.allFamilyInfo[e.activeKey]||[];return t}},mutations:{setPredefinedData:function(e,t){e.allFamilyInfo=Object(z["a"])({},e.allFamilyInfo,t)},updateActiveKey:function(e,t){e.activeKey=t},newFamily:function(e,t){var a=e.allFamilyInfo;Array.isArray(a[t])||(e.allFamilyInfo[t]=[],e.treeFamilyInfo[t]={name:t,children:[]}),e.activeKey=t},updatePeopleInfo:function(e,t){var a=t.id;if(a){var n=e.allFamilyInfo[e.activeKey],i=n.findIndex(function(e){return e.id===a});n.splice(i,1,t)}},deletePeopleInfo:function(e,t){var a=t.id;if(a){var n=e.allFamilyInfo[e.activeKey],i=n.findIndex(function(e){return e.id===a});n.splice(i,1)}},createPeopleInfo:function(e,t){var a=e.allFamilyInfo[e.activeKey],n=a.length,i=function(){var e=1;return 0===n||(e=parseInt(a[n-1].id)+1),e}(),r=Object(z["a"])({},t,{id:i});a.push(r)}},actions:{},plugins:[Z.plugin]}),te=a("56be"),ae=a.n(te);a("2ed4");n["default"].config.productionTip=!1,n["default"].use(ae.a),new n["default"]({router:W,store:ee,render:function(e){return e(c)}}).$mount("#app")},8300:function(e,t,a){},a97b:function(e,t,a){},ac2e:function(e,t,a){"use strict";var n=a("44f9"),i=a.n(n);i.a},b3b3:function(e,t,a){"use strict";var n=a("8300"),i=a.n(n);i.a},ba0f:function(e,t,a){}});
//# sourceMappingURL=app.c4be7f01.js.map