# 需求
- 一个宣传所用的web页面，如视频所展示，包括页面切换，图表及内容的展示、动画
# 准备工作
- 切图
    - 已被切好，可直接用
- 资源引入
- 技术设想
    - 使用fullPage插件完成页面的切换与响应
    - 页面组织结构
        - 直接使用静态页绘制，一个一个的做，设置动画
            - 优点，方便快捷不用管逻辑和js适配
            - 缺点，单页较多时速度太慢了
        - 使用js构建出网页，实现只需设置数据即能配置好各种结构，即本课所讲的组件式开发

# 开发过程记录
- 测试技术方向是否可行
    - 实验fullPage是否能完成需求，使用简略静态页测试 staticPage.html
        - fullPage规则参照![fullPage](http://www.dowebok.com/77.html)
        - 实测fullPage使用正常
    - 动画使用jQ动画进行展示，当fullPage切换页面触发事件时触发动画
        - 对于已经触发过的页面，利用回调函数重置状态，下次滚动到此页时依然可以重置
        - 利用回调函数有一个问题，即快速翻页时由于js是单线程，所以只能等待上一个没有执行完的执行完毕再执行当前页面。用事件或许可以解决此问题。
- 抽象提取
    - 分析
        - 绘制页的部分
            - 绘制图表的部分
            - 绘制图文的部分
        - 组件配置数据类型
            - css
                - 位置
                - 大小
            - 动画
                - 进来的动画
                - 离开的动画
            - 图片
                - 加工（CSS3属性使用
                - 地址
            - 文字
                - 文字位置
                - 文字大小
    - 页面的绘制
        - 目的
            - 绘制一个class="section"的div，让fullPage完成页面切换
            - 单纯的fullPage回调函数不能下放至组件使用,要把事件传递至组件
                - 但是如何把事件定位到那一页呢？
                    - 触发的时候就用回调函数触发那一页的事件即可
            - 页面要接收的并不是配置项，而是组件，把组件插入到自己的dom结构中
                - 也可返回这个dom由组件自己往上添加
            - 页面的CSS应该只有背景一个项目，这一个可以在CSS文件中进行设置，省却js的执行时间
    - 组件
        - 目的
            - 依然是创造一个dom结构
            - 配置这个dom结构的一切内容
        - 其他
            - class的生成使用页面名加组件名组成独一的class
        - 绘制图片部分
            - 配置图片参数
                - 组件负责生成节点，并设置节点属性
                - 因为使用字面量一个个配置太复杂所以设置了函数用来生成配置项
                - 图片的大小是一个难点，因为材料是依照iPhone进行设计的，切图下来图片为高清，大小是标准的两倍。
                    - 此问题的本质在于如何还原页面设计稿
                    - 为了解决这个问题，我尝试了使用jQ来获取图片宽度来重新设置图片宽度，但不加载出来就失败
                    - 于是在dom结构中添加一个img用来预加载并获取宽度值，依然不行
                    - 想到预处理图片使图片都是现在的一半宽高
                    - 上述方法都有问题，即在iPhone是不能正常显示的。视频中是直接把宽度值改为图片的一半，依然在iPhone上不能正常显示。好吧，安卓上也不太能正常显示，因为dpr的也都不是设置的1，囧。。
                    - 采用js生成meta标签的方法修改dpr，详细参见：![淘宝前端的适配方案](https://github.com/amfe/article/issues/17)
                    [!移动端高清、多屏适配方案](http://www.html-js.com/article/Mobile-terminal-H5-mobile-terminal-HD-multi-screen-adaptation-scheme%203041)
                        - 最后决定先强制页面scale
                        - 居中也使用百分比进行设置（margin要设置宽度才能生效）
                        - 对rem的转换没有使用插件而是在函数中进行设置
                            - 依照淘宝的方法把设计图分作十份，则font-size应为64px
                - 对原素材的标注使用像素大厨，切图使用ps来导出
        - 绘制文字部分
            - 配置文字参数
                - 文字的配置其实都在于css，使用了函数来构建css各项属性后直接输入就好
        - 绘制图表
            - 因为echarts比较好用就直接使用echarts进行配置了
            - 配置过程
                - 同样是构建一个dom使之成为echarts对象
                - 因为dom必须渲染到dom树上才能被echarts获取到宽高，所以让其响应加载事件以完成对象的渲染
            - 参数设置
                - 只能去看echarts文档了，各种参数设置真是多多多多多
            - 错误
                - 设计图的错误
                    - 折线图数据和折线明显不对
                    - 饼图比例也是明显不对 
                        - 但是可以设置最小角度
        - 动画的触发
            - 分析
                - 触发机制
                    - 事件响应机制，当触发事件时动画被执行
                - 事件的设置
                    - 依照fullPage的回调函数来设计

# 遇到的问题
- CSS
    - calc()的使用居然要在运算符两边加上空格，原来居然没有注意到，就是因为都自动格式化了。。。
    - 发现CSS的配置项真多啊，一个一个的加快加了十几项了，于是把它的配置改成语句判定了
    - 使用rem几位小数后省略的貌似有点多了，像素和实际的都不符了
        - 乌龙了，html的size设错了，设成65了。。。
- 动画
    - 配置.face_left_img的动画时，不知道为什么就是没动画，但操作是对的，在添加setTimeout后动画有了，不知道为何
    - 事件响应对象开始弄错了，一直想着让所有的组件动画全对页面的事件进行响应，后来才发现还是触发组件上的事件比较方便
- js操作
    - reduce()把我折腾死了，想用它自动把padding给处理成rem的字符串，然而好像会故意忽略0
    - 不过那里也不应该使用reduce，只是想尝试一下
- 配置组件
    - 组件参数的生成
        - 这个函数的参数到底如何设置才比较方便？
            - 如果把参数设为对象，则输入时要一个个输进去
            - 如果像这样设置多个参数，输入时也要给参数留空
                - 目前我选择这一种
- 图表
    - 折线图
        - 要配置的简直太太太多了啊！！！！！
        - echarts的大小不知道是怎么控制的，折腾了很久也不能弄到和设计图一样，只好作罢
        - 不知道如何把y轴标签隐藏但是保留分隔区域
        - 其他的都还原的几乎一样，包括颜色的取值等等等
    - 饼图
        - 颜色的设置居然和文档不一样啊摔，原来要设置在外面才行啊函数和渐变才要在里面啊啊啊